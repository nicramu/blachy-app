const mongoose = require("mongoose")
const bcrypt = require("bcrypt")
const blocklist = require("./blocklist.json")

const CommentsSchema = new mongoose.Schema({
    value: { type: String, minLength: [3, "comment too short, minimum 3 characters"], maxLength: [500, "comment too long, maximum 500 characters"] },
    date: { type: Date, default: Date.now },
    points: { value: { type: Number, default: 0 }, votedPlus: [{ type: mongoose.Schema.Types.ObjectId, ref: 'User' }], votedMinus: [{ type: mongoose.Schema.Types.ObjectId, ref: 'User' }] },
    plate: { type: mongoose.Schema.Types.ObjectId, ref: 'Plate' },
    author: { type: mongoose.Schema.Types.ObjectId, ref: 'User', required: true },
    visible: { type: Boolean, default: true },
    flagged: { value: { type: Number, default: 0 }, flaggedBy: [{ type: String }] },
    media: {
        links: [],
        image: String,
        video: String
    }
})

const PlateSchema = new mongoose.Schema({
    value: { type: String, unique: true, required: true, minLength: [4, "plate too short, minimum 4 characters"], maxLength: [8, "plate too long, maximum 8 characters"], trim: true, uppercase: true, match: /^[a-zA-Z0-9]+$/ },
    owner: { requestedBy: [{ type: String, default: null }], user: { type: mongoose.Schema.Types.ObjectId, ref: 'User', required: false, default: null } },
    description: { type: String, maxLength: [300, "too much characters, max 300"], default: null },
    comments: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Comments' }],
    points: { value: { type: Number, default: 0 }, votedPlus: [{ type: mongoose.Schema.Types.ObjectId, ref: 'User' }], votedMinus: [{ type: mongoose.Schema.Types.ObjectId, ref: 'User' }] },
    geodata: { country: { type: String, default: null }, region: { type: String, default: null }, flag: { type: String, default: null } },
    views: { value: { type: Number, default: 0 }, viewedBy: [{ type: String }], qrScan: { type: Number, default: 0 } }
})

const UserSchema = new mongoose.Schema({
    username: { type: String, unique: true, trim: true, required: [true, "username is required"], minLength: [3, "username \"{VALUE}\" too short - minimum 3 characters"], maxLength: [69, "username too long, maximum 69 characters"] },
    password: { type: String, required: [true, "password is required"], minLength: [3, "password too short - minimum 3 characters"], maxLength: [64, "password too long, maximum 64 characters"] },
    registerDate: { type: Date, default: Date.now, required: true, immutable: true },
    role: { type: String, enum: ["Admin", "User", "Vip", "Moderator", "Guest"], default: "User" },
    token: { value: { type: String }, device: { type: String }, ip: { type: String }, created: { type: Date, default: Date.now, immutable: true }, modified: { type: Date } },
    owner: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Plate' }],
    comments: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Comments' }],
    reminders: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Plate' }]
})

const ClaimsSchema = new mongoose.Schema({
    plateValue: String,
    user: { type: mongoose.Schema.Types.ObjectId, ref: 'User' },
    vin: String,
    registerDate: String
})

UserSchema.pre("save", async function (next) {
    var user = this;

    if (!user.isModified('password')) return next();

    if (blocklist.username.some(name => user.username.toLowerCase().includes(name))) return next(new Error("username restricted"));

    // generate a salt
    const salt = await bcrypt.genSalt(10);
    //hash password
    const hashedPassword = await bcrypt.hash(user.password, salt);
    user.password = hashedPassword;
    next();

});

//find geo location of plate by its number
PlateSchema.pre('save', async function (next) {
    //trigger only when value has been changed - meaning creation of new plate
    if (this.isModified('value')) {
        //match plate identifier with country and region
        this.geodata.region = constantsUA[this.value.substring(0, 2).replace(/\d*/gi, "")]
        if (this.geodata.region) { this.geodata.country = "UA"; this.geodata.flag = "吼" }
        this.geodata.region = constantsPL[this.value.substring(0, 3).replace(/\d*/gi, "")]
        if (this.geodata.region) { this.geodata.country = "PL"; this.geodata.flag = "叼" }
        next()
    }
    next()
});

//if comment is flagged >X times, hide it
CommentsSchema.pre("updateOne", async function (next) {
    const comment = await this.model.findOne(this.getQuery());
    if (comment && comment.flagged.value > 50) {
        this._update.$set = { ...this._update.$set, visible: false };
    }
    next();
});

//trim comment text & get links
CommentsSchema.pre("save", async function (next) {
    //console.log("pre comment save")
    this.value = this.value.replace(/ {2,}/g, ' ').replace(/\n{3,}/g, '\n\n');
    //links
    const allowedDomains = ["imgur.com", "youtube.com", "youtu.be", "streamable.com"]
    const matches = this.value.match(/(https?:\/\/[^\s]+)/g)
    const links = matches ? Array.from(matches) : null
    if (links) {
        if (links.length > 3) { return next(new Error("too much links, max 3")) }
        const filteredLinks = links.filter(link => allowedDomains.some(domain => link.includes(domain)));
        this.media.links = filteredLinks
    }
    next();
});

//delete all user data
UserSchema.pre('deleteOne', { document: true, query: false }, async function (next) {
    // 'this' is the parent being removed. Provide callbacks here if you want
    // to be notified of the calls' result.
    //console.log("pre delete user")
    await mongoose.model('Comments').deleteMany({ author: this._id });
    await mongoose.model('Plate').updateMany({ 'owner.user': this._id }, { $set: { 'owner.user': null, description: null } });
    await mongoose.model('Claims').deleteMany({ user: this._id });

    next();
});

const User = mongoose.model("User", UserSchema)
const Plate = mongoose.model("Plate", PlateSchema)
const Comments = mongoose.model("Comments", CommentsSchema)
const Claims = mongoose.model("Claims", ClaimsSchema)

module.exports = { User, Plate, Comments, Claims }


const constantsPL = {
    "DJ": "Jelenia G贸ra",
    "DL": "Legnica",
    "DB": "Wabrzych",
    "DW": "Wrocaw",
    "DX": "Wrocaw",
    "DBL": "powiat bolesawiecki (Bolesawiec)",
    "DDZ": "powiat dzier偶oniowski (Dzier偶oni贸w)",
    "DGL": "powiat gogowski (Gog贸w)",
    "DGR": "powiat g贸rowski (G贸ra)",
    "DJA": "powiat jaworski (Jawor)",
    "DJE": "powiat karkonoski (Jelenia G贸ra)",
    "DKA": "powiat kamiennog贸rski (Kamienna G贸ra)",
    "DKL": "powiat kodzki (Kodzko)",
    "DLE": "powiat legnicki (Legnica)",
    "DLB": "powiat lubaski (Luba)",
    "DLU": "powiat lubiski (Lubin)",
    "DLW": "powiat lw贸wecki (Lw贸wek lski)",
    "DMI": "powiat milicki (Milicz)",
    "DOL": "powiat olenicki (Olenica)",
    "DOA": "powiat oawski (Oawa)",
    "DPL": "powiat polkowicki (Polkowice)",
    "DST": "powiat strzeliski (Strzelin)",
    "DSR": "powiat redzki (roda lska)",
    "DSW": "powiat widnicki (widnica)",
    "DTR": "powiat trzebnicki (Trzebnica)",
    "DBA": "powiat wabrzyski (Wabrzych)",
    "DWL": "powiat woowski (Wo贸w)",
    "DWR": "powiat wrocawski (Wrocaw)",
    "VWR": "powiat wrocawski (Wrocaw)",
    "DZA": "powiat zbkowicki (Zbkowice lskie)",
    "DZG": "powiat zgorzelecki (Zgorzelec)",
    "DZL": "powiat zotoryjski (Zotoryja)",
    "CB": "Bydgoszcz",
    "CG": "Grudzidz",
    "CT": "Toru",
    "CW": "Wocawek",
    "CAL": "powiat aleksandrowski (Aleksandr贸w Kujawski)",
    "CBR": "powiat brodnicki (Brodnica)",
    "CBY": "powiat bydgoski (Bydgoszcz)",
    "CCH": "powiat chemiski (Chemno)",
    "CGD": "powiat golubsko-dobrzyski (Golub-Dobrzy)",
    "CGR": "powiat grudzidzki (Grudzidz)",
    "CIN": "powiat inowrocawski (Inowrocaw)",
    "CLI": "powiat lipnowski (Lipno)",
    "CMG": "powiat mogileski (Mogilno)",
    "CNA": "powiat nakielski (Nako nad Noteci)",
    "CRA": "powiat radziejowski (Radziej贸w)",
    "CRY": "powiat rypiski (Rypin)",
    "CSE": "powiat spoleski (Sp贸lno Krajeskie)",
    "CSW": "powiat wiecki (wiecie)",
    "CTR": "powiat toruski (Toru)",
    "CTU": "powiat tucholski (Tuchola)",
    "CWA": "powiat wbrzeski (Wbrze藕no)",
    "CWL": "powiat wocawski (Wocawek)",
    "CZN": "powiat 偶niski (呕nin)",
    "LB": "Biaa Podlaska",
    "LC": "Chem",
    "LU": "Lublin",
    "LZ": "Zamo",
    "LBI": "powiat bialski (Biaa Podlaska)",
    "LBL": "powiat bigorajski (Bigoraj)",
    "LCH": "powiat chemski (Chem)",
    "LHR": "powiat hrubieszowski (Hrubiesz贸w)",
    "LJA": "powiat janowski (Jan贸w Lubelski)",
    "LKS": "powiat krasnostawski (Krasnystaw)",
    "LKR": "powiat kranicki (Kranik)",
    "LLB": "powiat lubartowski (Lubart贸w)",
    "LUB": "powiat lubelski (Lublin)",
    "LLE": "powiat czyski (czna)",
    "LLU": "powiat ukowski (uk贸w)",
    "LOP": "powiat opolski (Opole Lubelskie)",
    "LPA": "powiat parczewski (Parczew)",
    "LPU": "powiat puawski (Puawy)",
    "LRA": "powiat radzyski (Radzy Podlaski)",
    "LRY": "powiat rycki (Ryki)",
    "LSW": "powiat widnicki (widnik)",
    "LTM": "powiat tomaszowski (Tomasz贸w Lubelski)",
    "LWL": "powiat wodawski (Wodawa)",
    "LZA": "powiat zamojski (Zamo)",
    "FG": "Gorz贸w Wielkopolski",
    "FZ": "Zielona G贸ra",
    "FGW": "powiat gorzowski (Gorz贸w Wielkopolski)",
    "FKR": "powiat kronieski (Krosno Odrzaskie)",
    "FMI": "powiat midzyrzecki (Midzyrzecz)",
    "FNW": "powiat nowosolski (Nowa S贸l)",
    "FSL": "powiat subicki (Subice)",
    "FSD": "powiat strzelecko-drezdenecki (Strzelce Krajeskie)",
    "FSU": "powiat sulciski (Sulcin)",
    "FSW": "powiat wiebodziski (wiebodzin)",
    "FWS": "powiat wschowski (Wschowa)",
    "FZI": "powiat zielonog贸rski (Zielona G贸ra)",
    "FZG": "powiat 偶agaski (呕aga)",
    "FZA": "powiat 偶arski (呕ary)",
    "EL": "贸d藕",
    "ED": "贸d藕",
    "EP": "Piotrk贸w Trybunalski",
    "ES": "Skierniewice",
    "EBE": "powiat bechatowski (Bechat贸w)",
    "EBR": "powiat brzeziski (Brzeziny)",
    "EKU": "powiat kutnowski (Kutno)",
    "ELA": "powiat aski (ask)",
    "ELE": "powiat czycki (czyca)",
    "ELC": "powiat owicki (owicz)",
    "ELW": "powiat 贸dzki wschodni (贸d藕)",
    "EOP": "powiat opoczyski (Opoczno)",
    "EPA": "powiat pabianicki (Pabianice)",
    "EPJ": "powiat pajczaski (Pajczno)",
    "EPI": "powiat piotrkowski (Piotrk贸w Trybunalski)",
    "EPD": "powiat poddbicki (Poddbice)",
    "ERA": "powiat radomszczaski (Radomsko)",
    "ERW": "powiat rawski (Rawa Mazowiecka)",
    "ESI": "powiat sieradzki (Sieradz)",
    "ESK": "powiat skierniewicki (Skierniewice)",
    "ETM": "powiat tomaszowski (Tomasz贸w Mazowiecki)",
    "EWI": "powiat wieluski (Wielu)",
    "EWE": "powiat wieruszowski (Wierusz贸w)",
    "EZD": "powiat zduskowolski (Zduska Wola)",
    "EZG": "powiat zgierski (Zgierz)",
    "KR": "Krak贸w",
    "KK": "Krak贸w",
    "KN": "Nowy Scz",
    "KT": "Tarn贸w",
    "KBC": "powiat bocheski (Bochnia)",
    "KBA": "powiat bocheski (Bochnia)",
    "KBR": "powiat brzeski (Brzesko)",
    "KCH": "powiat chrzanowski (Chrzan贸w)",
    "KDA": "powiat dbrowski (Dbrowa Tarnowska)",
    "KGR": "powiat gorlicki (Gorlice)",
    "KRA": "powiat krakowski (Krak贸w)",
    "KLI": "powiat limanowski (Limanowa)",
    "KMI": "powiat miechowski (Miech贸w)",
    "KMY": "powiat mylenicki (Mylenice)",
    "KNS": "powiat nowosdecki (Nowy Scz)",
    "KNT": "powiat nowotarski (Nowy Targ)",
    "KOL": "powiat olkuski (Olkusz)",
    "KOS": "powiat owicimski (Owicim)",
    "KPR": "powiat proszowicki (Proszowice)",
    "KSU": "powiat suski (Sucha Beskidzka)",
    "KTA": "powiat tarnowski (Tarn贸w)",
    "KTT": "powiat tatrzaski (Zakopane)",
    "KWA": "powiat wadowicki (Wadowice)",
    "KWI": "powiat wielicki (Wieliczka)",
    "WB": "Warszawa Bemowo",
    "WA": "Warszawa Biaoka",
    "WD": "Warszawa Bielany",
    "WE": "Warszawa Mokot贸w",
    "WU": "Warszawa Ochota",
    "WF": "Warszawa Praga-Poudnie",
    "WH": "Warszawa Praga-P贸noc",
    "WW": "Warszawa",
    "WI": "Warszawa r贸dmiecie",
    "WJ": "Warszawa Targ贸wek",
    "WK": "Warszawa Ursus",
    "WN": "Warszawa Ursyn贸w",
    "WT": "Warszawa Wawer",
    "WY": "Warszawa Wola",
    "WX": "Warszawa 呕oliborz",
    "WO": "Ostroka",
    "WP": "Pock",
    "WR": "Radom",
    "WS": "Siedlce",
    "WBR": "powiat biaobrzeski (Biaobrzegi)",
    "WCI": "powiat ciechanowski (Ciechan贸w)",
    "WG": "powiat garwoliski (Garwolin)",
    "WGS": "powiat gostyniski (Gostynin)",
    "WGM": "powiat grodziski (Grodzisk Mazowiecki)",
    "WGR": "powiat gr贸jecki (Gr贸jec)",
    "WKZ": "powiat kozienicki (Kozienice)",
    "WL": "powiat legionowski (Legionowo)",
    "WLI": "powiat lipski (Lipsko)",
    "WLS": "powiat osicki (osice)",
    "WMA": "powiat makowski (Mak贸w Mazowiecki)",
    "WM": "powiat miski (Misk Mazowiecki)",
    "WML": "powiat mawski (Mawa)",
    "WND": "powiat nowodworski (Nowy Dw贸r Mazowiecki)",
    "WOS": "powiat ostrocki (Ostroka)",
    "WOR": "powiat ostrowski (Ostr贸w Mazowiecka)",
    "WOT": "powiat otwocki (Otwock)",
    "WPI": "powiat piaseczyski (Piaseczno)",
    "WPA": "powiat piaseczyski (Piaseczno)",
    "WPL": "powiat pocki (Pock)",
    "WPN": "powiat poski (Posk)",
    "WPR": "powiat pruszkowski (Pruszk贸w)",
    "WPP": "powiat pruszkowski (Pruszk贸w)",
    "WPS": "powiat pruszkowski (Pruszk贸w)",
    "WPZ": "powiat przasnyski (Przasnysz)",
    "WPY": "powiat przysuski (Przysucha)",
    "WPU": "powiat putuski (Putusk)",
    "WRA": "powiat radomski (Radom)",
    "WSI": "powiat siedlecki (Siedlce)",
    "WSE": "powiat sierpecki (Sierpc)",
    "WSC": "powiat sochaczewski (Sochaczew)",
    "WSK": "powiat sokoowski (Soko贸w Podlaski)",
    "WSZ": "powiat szydowiecki (Szydowiec)",
    "WZ": "powiat warszawski zachodni (O偶ar贸w Mazowiecki)",
    "WWE": "powiat wgrowski (Wgr贸w)",
    "WWL": "powiat woomiski (Woomin)",
    "WV": "powiat woomiski (Woomin)",
    "WWY": "powiat wyszkowski (Wyszk贸w)",
    "WZW": "powiat zwoleski (Zwole)",
    "WZU": "powiat 偶uromiski (呕uromin)",
    "WZY": "powiat 偶yrardowski (呕yrard贸w)",
    "OP": "Opole",
    "OB": "powiat brzeski (Brzeg)",
    "OGL": "powiat gubczycki (Gubczyce)",
    "OK": "powiat kdzierzysko-kozielski (Kdzierzyn-Ko藕le)",
    "OKL": "powiat kluczborski (Kluczbork)",
    "OKR": "powiat krapkowicki (Krapkowice)",
    "ONA": "powiat namysowski (Namys贸w)",
    "ONY": "powiat nyski (Nysa)",
    "OOL": "powiat oleski (Olesno)",
    "OPO": "powiat opolski (Opole)",
    "OPR": "powiat prudnicki (Prudnik)",
    "OST": "powiat strzelecki (Strzelce Opolskie)",
    "RK": "Krosno",
    "RP": "Przemyl",
    "RZ": "Rzesz贸w",
    "RT": "Tarnobrzeg",
    "RBI": "powiat bieszczadzki (Ustrzyki Dolne)",
    "RBR": "powiat brzozowski (Brzoz贸w)",
    "RDE": "powiat dbicki (Dbica)",
    "RJA": "powiat jarosawski (Jarosaw)",
    "RJS": "powiat jasielski (Jaso)",
    "RKL": "powiat kolbuszowski (Kolbuszowa)",
    "RKR": "powiat kronieski (Krosno)",
    "RLS": "powiat leski (Lesko)",
    "RLE": "powiat le偶ajski (Le偶ajsk)",
    "RLU": "powiat lubaczowski (Lubacz贸w)",
    "RLA": "powiat acucki (acut)",
    "RMI": "powiat mielecki (Mielec)",
    "RNI": "powiat ni偶aski (Nisko)",
    "RPR": "powiat przemyski (Przemyl)",
    "RPZ": "powiat przeworski (Przeworsk)",
    "RRS": "powiat ropczycko-sdziszowski (Ropczyce)",
    "RZE": "powiat rzeszowski (Rzesz贸w)",
    "RSA": "powiat sanocki (Sanok)",
    "RST": "powiat stalowowolski (Stalowa Wola)",
    "RSR": "powiat strzy偶owski (Strzy偶贸w)",
    "RTA": "powiat tarnobrzeski (Tarnobrzeg)",
    "BI": "Biaystok",
    "BL": "om偶a",
    "BS": "Suwaki",
    "BAU": "powiat augustowski (August贸w)",
    "BIA": "powiat biaostocki (Biaystok)",
    "BBI": "powiat bielski (Bielsk Podlaski)",
    "BGR": "powiat grajewski (Grajewo)",
    "BHA": "powiat hajnowski (Hajn贸wka)",
    "BKL": "powiat kolneski (Kolno)",
    "BLM": "powiat om偶yski (om偶a)",
    "BMN": "powiat moniecki (Moki)",
    "BSE": "powiat sejneski (Sejny)",
    "BSI": "powiat siemiatycki (Siemiatycze)",
    "BSK": "powiat sok贸lski (Sok贸ka)",
    "BSU": "powiat suwalski (Suwaki)",
    "BWM": "powiat wysokomazowiecki (Wysokie Mazowieckie)",
    "BZA": "powiat zambrowski (Zambr贸w)",
    "GD": "Gdask",
    "XD": "Gdask",
    "GA": "Gdynia",
    "GS": "Supsk",
    "GSP": "Sopot",
    "GBY": "powiat bytowski (Byt贸w)",
    "GCH": "powiat chojnicki (Chojnice)",
    "GCZ": "powiat czuchowski (Czuch贸w)",
    "GDA": "powiat gdaski (Pruszcz Gdaski)",
    "GKA": "powiat kartuski (Kartuzy)",
    "GKY": "powiat kartuski (Kartuzy) - dla pojazd贸w zabytkowych",
    "GKS": "powiat kocierski (Kocierzyna)",
    "GKW": "powiat kwidzyski (Kwidzyn)",
    "GLE": "powiat lborski (Lbork)",
    "GMB": "powiat malborski (Malbork)",
    "GND": "powiat nowodworski (Nowy Dw贸r Gdaski)",
    "GPU": "powiat pucki (Puck)",
    "GSL": "powiat supski (Supsk)",
    "GST": "powiat starogardzki (Starogard Gdaski)",
    "GSZ": "powiat sztumski (Sztum)",
    "GTC": "powiat tczewski (Tczew)",
    "GWE": "powiat wejherowski (Wejherowo)",
    "GWO": "powiat wejherowski (Wejherowo)",
    "SB": "Bielsko-Biaa",
    "SY": "Bytom",
    "SH": "Chorz贸w",
    "SC": "Czstochowa",
    "SD": "Dbrowa G贸rnicza",
    "SG": "Gliwice",
    "SJZ": "Jastrzbie-Zdr贸j",
    "SJ": "Jaworzno",
    "SK": "Katowice",
    "SM": "Mysowice",
    "SPI": "Piekary lskie",
    "SL": "Ruda lska",
    "SRS": "Ruda lska",
    "SR": "Rybnik",
    "SI": "Siemianowice lskie",
    "SO": "Sosnowiec",
    "SW": "witochowice",
    "ST": "Tychy",
    "SZ": "Zabrze",
    "SZO": "呕ory",
    "SBE": "powiat bdziski (Bdzin)",
    "SBI": "powiat bielski (Bielsko-Biaa)",
    "SBL": "powiat bierusko-ldziski (Bieru)",
    "STY": "powiat tyski (Tychy)",
    "SCI": "powiat cieszyski (Cieszyn)",
    "SCN": "powiat cieszyski (Cieszyn)",
    "SCZ": "powiat czstochowski (Czstochowa)",
    "SGL": "powiat gliwicki (Gliwice)",
    "SKL": "powiat kobucki (Kobuck)",
    "SLU": "powiat lubliniecki (Lubliniec)",
    "SMI": "powiat mikoowski (Miko贸w)",
    "SMY": "powiat myszkowski (Myszk贸w)",
    "SPS": "powiat pszczyski (Pszczyna)",
    "SRC": "powiat raciborski (Racib贸rz)",
    "SRB": "powiat rybnicki (Rybnik)",
    "STA": "powiat tarnog贸rski (Tarnowskie G贸ry)",
    "SWD": "powiat wodzisawski (Wodzisaw lski)",
    "SWZ": "powiat wodzisawski (Wodzisaw lski)",
    "SZA": "powiat zawierciaski (Zawiercie)",
    "SZY": "powiat 偶ywiecki (呕ywiec)",
    "TK": "Kielce",
    "TBU": "powiat buski (Busko Zdr贸j)",
    "TJE": "powiat jdrzejowski (Jdrzej贸w)",
    "TKA": "powiat kazimierski (Kazimierza Wielka)",
    "TKI": "powiat kielecki (Kielce)",
    "TKN": "powiat konecki (Koskie)",
    "TOP": "powiat opatowski (Opat贸w)",
    "TOS": "powiat ostrowiecki (Ostrowiec witokrzyski)",
    "TPI": "powiat piczowski (Picz贸w)",
    "TSA": "powiat sandomierski (Sandomierz)",
    "TSK": "powiat skar偶yski (Skar偶ysko-Kamienna)",
    "TST": "powiat starachowicki (Starachowice)",
    "TSZ": "powiat staszowski (Stasz贸w)",
    "TLW": "powiat woszczowski (Woszczowa)",
    "NE": "Elblg",
    "NO": "Olsztyn",
    "NBA": "powiat bartoszycki (Bartoszyce)",
    "NBR": "powiat braniewski (Braniewo)",
    "NDZ": "powiat dziadowski (Dziadowo)",
    "NEB": "powiat elblski (Elblg)",
    "NEL": "powiat ecki (Ek)",
    "NGI": "powiat gi偶ycki (Gi偶ycko)",
    "NGO": "powiat godapski (Godap)",
    "NOG": "powiat olecko-godapski (Olecko)",
    "NIL": "powiat iawski (Iawa)",
    "NKE": "powiat ktrzyski (Ktrzyn)",
    "NLI": "powiat lidzbarski (Lidzbark Warmiski)",
    "NMR": "powiat mrgowski (Mrgowo)",
    "NNI": "powiat nidzicki (Nidzica)",
    "NNM": "powiat nowomiejski (Nowe Miasto Lubawskie)",
    "NOE": "powiat olecki (Olecko)",
    "NOL": "powiat olsztyski (Olsztyn)",
    "NOS": "powiat ostr贸dzki (Ostr贸da)",
    "NPI": "powiat piski (Pisz)",
    "NSZ": "powiat szczycieski (Szczytno)",
    "NWE": "powiat wgorzewski (Wgorzewo)",
    "PK": "Kalisz",
    "PA": "Kalisz",
    "PN": "Konin",
    "PKO": "Konin",
    "PL": "Leszno",
    "PO": "Pozna",
    "PY": "Pozna",
    "PCH": "powiat chodzieski (Chodzie偶)",
    "PCT": "powiat czarnkowsko-trzcianecki (Czarnk贸w)",
    "PGN": "powiat gnie藕nieski (Gniezno)",
    "PGS": "powiat gostyski (Gosty)",
    "PGO": "powiat grodziski (Grodzisk Wielkopolski)",
    "PJA": "powiat jarociski (Jarocin)",
    "PKA": "powiat kaliski (Kalisz)",
    "PKE": "powiat kpiski (Kpno)",
    "PKL": "powiat kolski (Koo)",
    "PKN": "powiat koniski (Konin)",
    "PKS": "powiat kociaski (Kocian)",
    "PKR": "powiat krotoszyski (Krotoszyn)",
    "PLE": "powiat leszczyski (Leszno)",
    "PMI": "powiat midzychodzki (Midzych贸d)",
    "PNT": "powiat nowotomyski (Nowy Tomyl)",
    "POB": "powiat obornicki (Oborniki)",
    "POS": "powiat ostrowski (Ostr贸w Wielkopolski)",
    "POT": "powiat ostrzeszowski (Ostrzesz贸w)",
    "PP": "powiat pilski (Pia)",
    "PPL": "powiat pleszewski (Pleszew)",
    "PZ": "powiat poznaski (Pozna)",
    "POZ": "powiat poznaski (Pozna)",
    "PRA": "powiat rawicki (Rawicz)",
    "PSL": "powiat supecki (Supca)",
    "PSZ": "powiat szamotulski (Szamotuy)",
    "PSE": "powiat remski (rem)",
    "PSR": "powiat redzki (roda Wielkopolska)",
    "PTU": "powiat turecki (Turek)",
    "PWA": "powiat wgrowiecki (Wgrowiec)",
    "PWL": "powiat wolsztyski (Wolsztyn)",
    "PWR": "powiat wrzesiski (Wrzenia)",
    "PZL": "powiat zotowski (Zot贸w)",
    "ZK": "Koszalin",
    "ZS": "Szczecin",
    "ZZ": "Szczecin",
    "ZSW": "winoujcie",
    "ZBI": "powiat biaogardzki (Biaogard)",
    "ZCH": "powiat choszczeski (Choszczno)",
    "ZDR": "powiat drawski (Drawsko Pomorskie)",
    "ZGL": "powiat goleniowski (Goleni贸w)",
    "ZGY": "powiat gryficki (Gryfice)",
    "ZGR": "powiat gryfiski (Gryfino)",
    "ZKA": "powiat kamieski (Kamie Pomorski)",
    "ZKL": "powiat koobrzeski (Koobrzeg)",
    "ZKO": "powiat koszaliski (Koszalin)",
    "ZLO": "powiat obeski (obez) (od 1 stycznia 2002)",
    "ZMY": "powiat myliborski (Mylib贸rz)",
    "ZPL": "powiat policki (Police)",
    "ZPY": "powiat pyrzycki (Pyrzyce)",
    "ZSL": "powiat sawieski (Sawno)",
    "ZST": "powiat stargardzki (Stargard)",
    "ZSZ": "powiat szczecinecki (Szczecinek)",
    "ZSD": "powiat widwiski (widwin)",
    "ZWA": "powiat waecki (Wacz)",
}

const constantsUA = {
    "AX": "obw贸d charkowski",
    "KX": "obw贸d charkowski",
    "BT": "obw贸d chersoski",
    "HT": "obw贸d chersoski",
    "BX": "obw贸d chmielnicki",
    "HX": "obw贸d chmielnicki",
    "CA": "obw贸d czerkaski",
    "IA": "obw贸d czerkaski",
    "CB": "obw贸d czernihowski",
    "IB": "obw贸d czernihowski",
    "CE": "obw贸d czerniowiecki",
    "IE": "obw贸d czerniowiecki",
    "AE": "obw贸d dniepropetrowski",
    "KE": "obw贸d dniepropetrowski",
    "AH": "obw贸d doniecki",
    "KH": "obw贸d doniecki",
    "AT": "obw贸d iwanofrankowski",
    "KT": "obw贸d iwanofrankowski",
    "AI": "obw贸d kijowski",
    "KI": "obw贸d kijowski",
    "AA": "miasto Kij贸w",
    "KA": "miasto Kij贸w",
    "BA": "obw贸d kirowohradzki",
    "NA": "obw贸d kirowohradzki",
    "BC": "obw贸d lwowski",
    "HC": "obw贸d lwowski",
    "BB": "obw贸d ugaski",
    "HB": "obw贸d ugaski",
    "BE": "obw贸d mikoajowski",
    "HE": "obw贸d mikoajowski",
    "BH": "obw贸d odeski",
    "HH": "obw贸d odeski",
    "BI": "obw贸d potawski",
    "HI": "obw贸d potawski",
    "AK": "Republika Autonomiczna Krymu",
    "KK": "Republika Autonomiczna Krymu",
    "BK": "obw贸d r贸wieski",
    "HK": "obw贸d r贸wieski",
    "CH": "miasto Sewastopol",
    "IH": "miasto Sewastopol",
    "BM": "obw贸d sumski",
    "HM": "obw贸d sumski",
    "BO": "obw贸d tarnopolski",
    "HO": "obw贸d tarnopolski",
    "AB": "obw贸d winnicki",
    "KB": "obw贸d winnicki",
    "AC": "obw贸d woyski",
    "KC": "obw贸d woyski",
    "AO": "obw贸d zakarpacki",
    "KO": "obw贸d zakarpacki",
    "AP": "obw贸d zaporoski",
    "KP": "obw贸d zaporoski",
    "AM": "obw贸d 偶ytomierski",
    "KM": "obw贸d 偶ytomierski",
    "II": "pojazdy pastwowe",
}